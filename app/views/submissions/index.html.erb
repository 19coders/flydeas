<p id="notice"><%= notice %></p>

<h1>Flydeas</h1>

<table>
  <thead>
    <tr>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <hr>
    <% @submissions.each do |submission| %>
      <div>
        <div>
          <%= submission.vote_count %> |
          <b><%= submission.category.name%></b> |
          <%= submission.created_at%> 
          <br>     
          <h2><%= submission.title%></h2>
          <br>
          <%= submission.content %>
          <br>
          <%= link_to 'Show', submission %>
          <%= link_to 'Edit', edit_submission_path(submission) %>
          <%= link_to 'Destroy', submission, method: :delete, data: { confirm: 'Are you sure?' } %>
          <% vote = Vote.find_by(post: submission, user_id: current_user.id) %>
          <% if vote.nil? || vote.weight == 0 %> 
            <%= link_to 'Upvote', submission_vote_path(submission_id: submission.id, user_id: current_user.id, weight: 1), method: :patch %>
          <% else %>
            <%= link_to 'Unvote', submission_vote_path(submission_id: submission.id, user_id: current_user.id, weight: 0), method: :patch %> 
          <% end %>
         <!-- <%= link_to 'Downvote', submission_vote_path(submission_id: submission.id, user_id: current_user.id, weight: -1), method: :patch %> -->
          <br>
          <% vote = Vote.find_by(post: submission, user_id: current_user.id) %>
          <hr>
          <br>

        </div>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Submission', new_submission_path %>
